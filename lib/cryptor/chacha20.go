// chacha20 only used for encrypt/decrypt handshake pack
package cryptor

import "golang.org/x/crypto/chacha20"

var fixedNonce = []byte{
	0x6b, 0x6f, 0x72, 0x30, 0x6e, 0x45,
	0x47, 0x6f, 0x64, 0x44, 0x4f, 0x47,
	0x5f, 0x77, 0x54, 0x6d, 0x6e, 0x6f,
	0x74, 0x77, 0x52, 0x6f, 0x6e, 0x67,
}

func XorStream(dst, src []byte, key string) {
	cip, _ := chacha20.NewUnauthenticatedCipher([]byte(key), fixedNonce)
	cip.XORKeyStream(dst, src)
}
